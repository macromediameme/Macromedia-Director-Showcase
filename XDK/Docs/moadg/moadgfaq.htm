<HTML><HEAD><TITLE>Frequently Asked Questions</TITLE></HEAD><body bgcolor="#FFFFFF"  link="#ff3300" alink="#ff3300" vlink="#333399"><A HREF="index.htm">MOA Developer's Guide</A><BR><A HREF="../moref/index.htm" >MOA Interfaces</A> | <A HREF="../moref/momthndx.htm" >MOA Methods</A>| <A HREF="../moref/motypndx.htm" >MOA Types and Misc API</A><HR width=45% align=left><H3><A NAME="RTFToC2"><FONT SIZE=4 face=arial,helvetica,sans-serif>Director 7 Xtra Development Kit: MOA Developer's Guide</FONT></A></H3><H2><FONT SIZE=5 face=arial,helvetica,sans-serif>Frequently Asked Questions</FONT></H2><HR width=45% align=left><DL><DT><DD></DL><h4><font face=arial,helvetica,sans-serif><A NAME="RTFToC6">How do I choose a value for a class or interface ID?</A></font></h4><DL><DT><DD>Currently there's only one &quot;safe&quot; way to do it:use a utility that generates a random one based on (among otherthings) your machine's Ethernet address and the date/time. Sinceall Ethernet adapters are supposed to have unique IDs, this shouldin theory be safe. Microsoft provides the utilities on Windowsmachines; we wrote a similar one of our own for Macintoshes. Feelfree to use any random values you like during development, butprior to release, you <B>must</B> get a &quot;real&quot; valuefrom such a utility.<BR><BR></DL><h4><font face=arial,helvetica,sans-serif><A NAME="RTFToC7">I get link errors saying that CLSID_xxx or IID_xxx are missing (or duplicate). What gives?</A></font></h4><DL><DT><DD>The macro DEFINE_GUID normally makes an &quot;extern&quot;declaration of the MoaID structure. However, if the macro INITGUIDis defined, the DEFINE_GUID macro actually declares the identifier.So... to make your files link correctly, you need to place #defineINITGUID at the top of exactly <B>one</B> file, before includingany header files.<BR><BR></DL><h4><font face=arial,helvetica,sans-serif><A NAME="RTFToC11">How do I access resources within my Xtra?</A></font></h4><DL><DT><DD>On the Mac, your Xtra may or may not have its resource fileopen at any given time. To avoid unnecessary resource-file openings(which would be uncool because it's a slow operation), we've setup a way for you to hook in to the possibly-already-open file.There are two calls in the <TT>PIMoaCallback</TT> for doing so, <TT>MoaBeginUsingResource()</TT> and <TT>MoaEndUsingResources()</TT>.Your Xtra will have a global called <TT>gXtraFileRef</TT>;this is <B>not</B> a resource file reference number, but a magictoken used to get it for you. To get the resource file referencenumber and make it the topmost in the resource chain, call MoaBeginUsingResources(),then use Get1xxx to get your resources. When you are done, callMoaEndUsingResource(); this will possibly close the resource file(note that the resource file is always opened read-only). You'llalso have to pass in a scratch variable that's used to save andrestore the same resource-chain state.<BR><BR>A bit of code example:<P><TT>XtraResourceCookie myCookie, saveCookie;<BR><BR>myCookie = This-&gt;pCallback-&gt;lpVtbl-&gt;MoaBeginUsingResources(This-&gt;pCallback,gXtraFileRef, &amp;saveCookie);<BR>h = Get1NamedResource(...);<BR>This-&gt;pCallback-&gt;lpVtbl-&gt;MoaEndUsingResources(This-&gt;pCallback,gXtraFileRef, saveCookie);<BR><BR></TT>Under Windows, the same rigmarole is used; the maindifference is that an &quot;XtraResourceCookie&quot; is reallyjust an HINSTANCE to your Xtra's DLL.<BR><BR></DL><h4><font face=arial,helvetica,sans-serif><A NAME="RTFToC12">I can't create any instances of my Xtra; I always get an error. What is wrong?</A><BR></font></h4><DL><DT><DD>Likely problem is you didn't export all the necessary functions(if you are using CFM or DLL).</DD></DL><hr width=45% align=left><P><A HREF="../copyrite.htm" >Copyright &#169; 1995, 1996, 1997, 1998, 1999 Macromedia, Inc.</A></BODY><!--#include virtual="/uber/html/footer.html" --></html>